-- Create TAIKHOAN table
CREATE TABLE TAIKHOAN (
    Username VARCHAR(50) PRIMARY KEY,
    Password VARCHAR(50) NOT NULL,
    Role VARCHAR(20) NOT NULL
);

-- Create QUANLY table
CREATE TABLE QUANLY (
    MaQuanLy VARCHAR(10) PRIMARY KEY,
    TenQuanLy VARCHAR(50) NOT NULL,
    CCCD VARCHAR(12) NOT NULL,
    NgaySinh DATE,
    GioiTinh BIT,
    QueQuan VARCHAR(100),
    SDT VARCHAR(15),
    Username VARCHAR(50) UNIQUE,
    FOREIGN KEY (Username) REFERENCES TAIKHOAN(Username)
);

-- Create SINHVIEN table
CREATE TABLE SINHVIEN (
    MSSV VARCHAR(10) PRIMARY KEY,
    HoTen VARCHAR(50) NOT NULL,
    CCCD VARCHAR(12) NOT NULL,
    NgaySinh DATE,
    GioiTinh BIT,
    QueQuan VARCHAR(100),
    TrangThai VARCHAR(20),
    Username VARCHAR(50) UNIQUE,
    FOREIGN KEY (Username) REFERENCES TAIKHOAN(Username)
);

-- Create DONDANGKY table
CREATE TABLE DONDANGKY (
    MaDonDangKy VARCHAR(10) PRIMARY KEY,
    MSSV VARCHAR(10) NOT NULL,
    NgayDangKy DATE NOT NULL,
    TrangThai VARCHAR(20) NOT NULL,
    LoaiPhong VARCHAR(10),
    MaLoaiPhong VARCHAR(10),
    DayPhong VARCHAR(10),
    MaDayPhong VARCHAR(10),
    FOREIGN KEY (MSSV) REFERENCES SINHVIEN(MSSV)
);

-- Create VIPHAM table
CREATE TABLE VIPHAM (
    MaViPham VARCHAR(10) PRIMARY KEY,
    MoTa TEXT,
    MucDo VARCHAR(20),
    HinhThucXuLy VARCHAR(50),
    MSSV VARCHAR(10) NOT NULL,
    FOREIGN KEY (MSSV) REFERENCES SINHVIEN(MSSV)
);

-- Create DAYPHONG table
CREATE TABLE DAYPHONG (
    MaDayPhong VARCHAR(10) PRIMARY KEY,
    TenDayPhong VARCHAR(50) NOT NULL,
    SoPhong INTEGER,
    DoiTuong VARCHAR(20)
);

-- Create PHONG table
CREATE TABLE PHONG (
    MaPhong VARCHAR(10) PRIMARY KEY,
    SoLuongSV INTEGER,
    MaLoaiPhong VARCHAR(10) NOT NULL,
    DayPhong VARCHAR(10) NOT NULL,
    MaDayPhong VARCHAR(10) NOT NULL,
    Gia INTEGER,
    TrangThai VARCHAR(20),
    FOREIGN KEY (MaDayPhong) REFERENCES DAYPHONG(MaDayPhong)
);

-- Create LOAIPHONG table
CREATE TABLE LOAIPHONG (
    MaLoaiPhong VARCHAR(10) PRIMARY KEY,
    TenLoaiPhong VARCHAR(50) NOT NULL,
    SoLuong INTEGER
);

-- Create HOPDONG table
CREATE TABLE HOPDONG (
    MaHopDong VARCHAR(10) PRIMARY KEY,
    NgayVao DATE,
    NgayRa DATE,
    MaPhong VARCHAR(10) NOT NULL,
    MSSV VARCHAR(10) NOT NULL,
    FOREIGN KEY (MaPhong) REFERENCES PHONG(MaPhong),
    FOREIGN KEY (MSSV) REFERENCES SINHVIEN(MSSV)
);

-- Create BAOHONG table
CREATE TABLE BAOHONG (
    MaBH VARCHAR(10) PRIMARY KEY,
    MoTa VARCHAR(200),
    NgayBao DATE,
    TrangThai VARCHAR(20),
    MaPhong VARCHAR(10) NOT NULL,
    FOREIGN KEY (MaPhong) REFERENCES PHONG(MaPhong)
);

-- Create HOADON table
CREATE TABLE HOADON (
    MaHoaDon VARCHAR(10) PRIMARY KEY,
    SoTien DECIMAL(10,2),
    LoaiHoaDon VARCHAR(20),
    NgayThanhToan DATE,
    MSSV VARCHAR(10) NOT NULL,
    Thang INTEGER,
    MaPhong VARCHAR(10) NOT NULL,
    FOREIGN KEY (MSSV) REFERENCES SINHVIEN(MSSV),
    FOREIGN KEY (MaPhong) REFERENCES PHONG(MaPhong)
);

-- Create TAISAN table
CREATE TABLE TAISAN (
    MaTaiSan VARCHAR(10) PRIMARY KEY,
    TenTaiSan VARCHAR(50) NOT NULL
);

-- Create CHITIETAISAN table
CREATE TABLE CHITIETAISAN (
    MaDayPhong VARCHAR(10) NOT NULL,
    MaLoaiPhong VARCHAR(10) NOT NULL,
    MaTaiSan VARCHAR(10) NOT NULL,
    SoLuong INTEGER,
    PRIMARY KEY (MaDayPhong, MaLoaiPhong, MaTaiSan),
    FOREIGN KEY (MaDayPhong) REFERENCES DAYPHONG(MaDayPhong),
    FOREIGN KEY (MaLoaiPhong) REFERENCES LOAIPHONG(MaLoaiPhong),
    FOREIGN KEY (MaTaiSan) REFERENCES TAISAN(MaTaiSan)
);
